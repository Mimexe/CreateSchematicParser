<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Mod Schematic Parser</title>
    <link rel="stylesheet" href="styles.css" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline';"
    />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>
          Create Mod Schematic Parser (beta version, bugs may and will surely
          appear)
        </h1>
        <p>
          Upload a .nbt schematic file from Minecraft Create mod to analyze its
          blocks and get required mods or minecraft version.
        </p>
        <div class="header-buttons">
          <button id="darkModeToggle" class="btn btn-primary">
            Toggle Dark Mode
          </button>
          <button
            id="loadLastSchematicMain"
            class="btn btn-primary"
            style="display: none"
          >
            Load Last Saved Schematic
          </button>
          <button id="loadSchematicMain" class="btn btn-primary">
            Load Saved Schematic
          </button>
        </div>
      </header>

      <main>
        <section class="upload-section">
          <div class="upload-area" id="uploadArea">
            <div class="upload-content">
              <svg
                class="upload-icon"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7,10 12,15 17,10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              <h3>Drop your .nbt file here</h3>
              <p>or click to browse</p>
              <input type="file" id="fileInput" accept=".nbt" hidden />
            </div>
          </div>

          <div
            class="progress-container"
            id="progressContainer"
            style="display: none"
          >
            <div class="progress-info">
              <span style="font-size: 10px"
                >Progress is not completely reliable</span
              >
              <h3 id="progressTitle">Processing schematic...</h3>
              <p id="progressStatus">Initializing...</p>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-percentage" id="progressPercentage">0%</div>
          </div>
        </section>

        <section id="results" class="results-section" style="display: none">
          <div class="results-header">
            <h2>Parsed Schematic Data</h2>
            <div class="header-actions">
              <button
                id="loadLastSchematic"
                class="btn-secondary"
                style="display: none"
              >
                <svg
                  class="btn-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                >
                  <path d="M3 3h18v18H3z"></path>
                  <path d="M8 12l2 2 4-4"></path>
                </svg>
                Load Last Schematic
              </button>
              <button
                id="saveSchematic"
                class="btn-secondary"
                style="display: none"
              >
                <svg
                  class="btn-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                >
                  <path
                    d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
                  ></path>
                  <polyline points="17,21 17,13 7,13 7,21"></polyline>
                  <polyline points="7,3 7,8 15,8"></polyline>
                </svg>
                Save Schematic
              </button>
              <button class="btn-secondary" onclick="location.href = '?noload'">
                <svg
                  class="btn-icon"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                >
                  <polyline points="23,4 23,10 17,10"></polyline>
                  <path d="M20.49,15a9,9,0,1,1-2.12-9.36L23,10"></path>
                </svg>
                Parse Another File
              </button>
            </div>
          </div>

          <div class="results-content">
            <div class="info-cards">
              <div class="info-card">
                <div class="info-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect
                      x="3"
                      y="3"
                      width="18"
                      height="18"
                      rx="2"
                      ry="2"
                    ></rect>
                    <circle cx="9" cy="9" r="2"></circle>
                    <path d="M21,15l-3.086-3.086a2,2,0,0,0-2.828,0L6,21"></path>
                  </svg>
                </div>
                <div class="info-content">
                  <div class="info-label">Minecraft Version</div>
                  <div class="info-value" id="minecraftVersion">-</div>
                </div>
              </div>

              <div class="info-card">
                <div class="info-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path
                      d="M21,16V8a2,2,0,0,0-1-1.73l-7-4a2,2,0,0,0-2,0l-7,4A2,2,0,0,0,3,8v8a2,2,0,0,0,1,1.73l7,4a2,2,0,0,0,2,0l7-4A2,2,0,0,0,21,16Z"
                    ></path>
                    <polyline points="3.27,6.96 12,12.01 20.73,6.96"></polyline>
                    <line x1="12" y1="22.08" x2="12" y2="12"></line>
                  </svg>
                </div>
                <div class="info-content">
                  <div class="info-label">Total Blocks</div>
                  <div class="info-value" id="totalBlocks">-</div>
                </div>
              </div>

              <div class="info-card">
                <div class="info-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M21,3H3V21H21V3Z"></path>
                    <path d="M9,9H15V15H9V9Z"></path>
                  </svg>
                </div>
                <div class="info-content">
                  <div class="info-label">Schematic Size</div>
                  <div class="info-value" id="schematicSize">-</div>
                </div>
              </div>
            </div>

            <div class="detected-mods">
              <h3>Detected Mods</h3>
              <ul id="modsList">
                <li>No mods detected</li>
              </ul>
            </div>

            <div class="blocks">
              <h3>Blocks</h3>
              <div id="blocksList" class="blocks-container">
                <div class="block-item-placeholder">No blocks detected</div>
              </div>
            </div>
          </div>
        </section>
        <div
          style="
            display: flex;
            justify-content: center;
            gap: 4px;
            padding-top: 15px;
          "
        >
          <input type="checkbox" name="autoLoad" id="autoLoad" />
          <label for="autoLoad">Auto-load last schematic</label>
        </div>
      </main>

      <footer>
        <p>
          Made with love by Mime4X (and AI for CSS and some part of nbt
          parser)<br />
          Version Beta 2.1 - Added mod to blocks
        </p>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
    <script src="data.js"></script>
    <script src="nbt-parser.js"></script>
    <script src="script.js"></script>
    <script>
      // dark mode
      const toggleDarkMode = () => {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "darkMode",
          document.body.classList.contains("dark-mode")
        );
      };

      // Load dark mode preference from localStorage
      const darkMode = localStorage.getItem("darkMode");
      if (darkMode === "true") {
        document.body.classList.add("dark-mode");
      }

      document
        .getElementById("darkModeToggle")
        .addEventListener("click", toggleDarkMode);
    </script>
  </body>
</html>
